<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Zorgstart ‚Äî Slimme intake (probleemgebieden ‚Üí zorgbundels)</title>
  <meta name="description" content="Slimme, dynamische intake: bijkomende vragen klappen open op basis van antwoorden. Output: probleemgebieden + voorstel zorgbundels + samenvatting voor matching." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <style>
    :root{
      --bg: #0b1020;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.08);
      --border: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --faint: rgba(255,255,255,.55);
      --accent: #7dd3fc;
      --accent2: #a78bfa;
      --good: #34d399;
      --warn: #fbbf24;
      --bad: #fb7185;

      --r: 18px;
      --shadow: 0 22px 60px rgba(0,0,0,.45);
      --max: 1160px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Helvetica Neue", sans-serif;
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 10% 10%, rgba(125,211,252,.20), transparent 55%),
        radial-gradient(900px 600px at 85% 18%, rgba(167,139,250,.18), transparent 60%),
        radial-gradient(800px 560px at 60% 90%, rgba(52,211,153,.10), transparent 55%),
        linear-gradient(180deg, #070a14, #0b1020 45%, #070a14);
    }
    a{color:inherit}
    .wrap{max-width:var(--max); margin:0 auto; padding:26px 18px 60px}
    .topbar{
      position: sticky; top:0; z-index:20;
      backdrop-filter: blur(12px);
      background: rgba(7,10,20,.55);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .topbar-inner{max-width:var(--max); margin:0 auto; padding:12px 18px; display:flex; align-items:center; gap:14px}
    .brand{display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.2px}
    .dot{width:11px; height:11px; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #fff, rgba(255,255,255,.2) 35%, transparent 70%),
                  linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: 0 0 0 4px rgba(125,211,252,.12);
    }
    .badge{
      font-size:12px; padding:4px 9px; border-radius:999px;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      color: var(--muted);
      font-weight:600;
    }
    .spacer{flex:1}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      font-size:12px; padding:7px 11px; border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      color: var(--muted);
    }

    /* HERO */
    .hero{
      margin-top:22px;
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.10);
      border-radius: calc(var(--r) + 6px);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .hero::after{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(520px 260px at 18% 0%, rgba(125,211,252,.22), transparent 55%),
        radial-gradient(520px 260px at 82% 0%, rgba(167,139,250,.20), transparent 55%);
      pointer-events:none;
      opacity:.9;
    }
    .hero-inner{position:relative; z-index:1; padding:26px 22px}
    .hero h1{margin:0 0 10px; font-size:26px; letter-spacing:-.2px}
    .lead{margin:0 0 14px; color: var(--muted); line-height:1.45}
    .row{display:flex; gap:12px; flex-wrap:wrap; align-items:center}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px; border-radius:999px;
      background: rgba(255,255,255,.07);
      border:1px solid rgba(255,255,255,.12);
      color: var(--muted);
      font-size:12px;
      font-weight:600;
    }
    .chip b{color: var(--text)}
    .chip .k{opacity:.9}

    /* GRID */
    .grid{display:grid; grid-template-columns: 1.1fr .9fr; gap:14px; margin-top:16px}
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} }

    .card{
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
      border-radius: var(--r);
      box-shadow: 0 18px 45px rgba(0,0,0,.25);
      overflow:hidden;
    }
    .card-h{
      padding:16px 16px 12px;
      border-bottom:1px solid rgba(255,255,255,.08);
      display:flex; justify-content:space-between; align-items:flex-start; gap:10px;
    }
    .card-h h2{margin:0; font-size:14px; letter-spacing:.2px}
    .sub{margin:4px 0 0; color: var(--muted); font-size:12px; line-height:1.35}
    .card-b{padding:16px}

    /* FORM */
    .form-grid{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    @media (max-width: 760px){ .form-grid{grid-template-columns:1fr} }
    label{display:block; font-size:12px; color: var(--muted); margin:0 0 6px}
    input, select, textarea{
      width:100%;
      padding:11px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.25);
      color: var(--text);
      outline:none;
    }
    textarea{min-height:90px; resize:vertical}
    input:focus, select:focus, textarea:focus{border-color: rgba(125,211,252,.55); box-shadow: 0 0 0 4px rgba(125,211,252,.12)}
    .help{color: var(--faint); font-size:12px; margin-top:6px; line-height:1.35}

    .section{
      margin-top:14px;
      border:1px solid rgba(255,255,255,.10);
      border-radius: 16px;
      background: rgba(255,255,255,.04);
      overflow:hidden;
    }
    .sec-h{
      padding:12px 12px;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      cursor:pointer;
      user-select:none;
    }
    .sec-h .ttl{
      display:flex; gap:10px; align-items:center;
      font-weight:700; letter-spacing:.15px;
      font-size:13px;
    }
    .ico{
      width:34px; height:34px; border-radius:12px;
      display:grid; place-items:center;
      background: rgba(125,211,252,.10);
      border:1px solid rgba(125,211,252,.18);
      color: var(--accent);
      font-weight:800;
      font-size:13px;
    }
    .sec-h .meta{color: var(--muted); font-size:12px}
    .sec-b{padding:12px 12px 14px; border-top:1px solid rgba(255,255,255,.08); display:none}
    .section[data-open="1"] .sec-b{display:block}

    .checks{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
    @media (max-width: 760px){ .checks{grid-template-columns:1fr} }
    .check{
      display:flex; gap:10px; align-items:flex-start;
      padding:10px 10px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }
    .check input{width:auto; margin-top:2px; accent-color: var(--accent)}
    .check b{display:block; font-size:13px}
    .check span{display:block; color: var(--muted); font-size:12px; margin-top:2px; line-height:1.3}

    .reveal{
      margin-top:10px;
      padding:10px 10px;
      border-radius: 14px;
      border:1px dashed rgba(255,255,255,.18);
      background: rgba(255,255,255,.03);
      display:none;
    }
    .reveal[data-show="1"]{display:block}

    .btnbar{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px}
    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding:10px 12px;
      border-radius: 14px;
      font-weight:700;
      cursor:pointer;
    }
    .btn.primary{
      background: linear-gradient(135deg, rgba(125,211,252,.22), rgba(167,139,250,.18));
      border-color: rgba(125,211,252,.35);
    }
    .btn:active{transform: translateY(1px)}
    .mini{font-size:12px; color: var(--muted)}

    /* RIGHT PANEL */
    .kpi{
      display:grid; grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .stat{
      padding:12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }
    .stat .n{font-size:22px; font-weight:800; letter-spacing:-.2px}
    .stat .t{font-size:12px; color: var(--muted); margin-top:2px}
    .list{
      margin-top:12px;
      display:flex; flex-direction:column; gap:10px
    }
    .item{
      padding:12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }
    .item .h{display:flex; justify-content:space-between; align-items:center; gap:10px}
    .tag{
      font-size:11px; font-weight:800;
      padding:5px 9px; border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--muted);
      white-space:nowrap;
    }
    .tag.good{border-color: rgba(52,211,153,.30); color: rgba(52,211,153,.95); background: rgba(52,211,153,.10)}
    .tag.warn{border-color: rgba(251,191,36,.30); color: rgba(251,191,36,.95); background: rgba(251,191,36,.10)}
    .tag.bad{border-color: rgba(251,113,133,.30); color: rgba(251,113,133,.95); background: rgba(251,113,133,.10)}
    .item p{margin:8px 0 0; color: var(--muted); font-size:12px; line-height:1.4}

    pre{
      margin:12px 0 0;
      padding:12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      color: rgba(255,255,255,.82);
      overflow:auto;
      font-size:12px;
      line-height:1.45;
    }

    .footer-note{margin-top:14px; color: var(--faint); font-size:12px; line-height:1.45}
  </style>
</head>

<body>
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <span class="dot"></span>
        <span>Zorgstart</span>
        <span class="badge">Slimme intake</span>
      </div>
      <div class="spacer"></div>
      <span class="pill">Probleemgebieden ‚Üí Zorgbundels ‚Üí Matching</span>
    </div>
  </div>

  <div class="wrap">
    <section class="hero">
      <div class="hero-inner">
        <h1>Intake met slimme openklappers</h1>
        <p class="lead">
          Deze vragenlijst opent automatisch bijkomende vragen wanneer nodig, en stelt op basis van antwoorden
          <b>probleemgebieden</b> en <b>zorgbundels</b> voor ‚Äî klaar voor Zorgstart V1 en de uitbreidingslogica richting matching.
        </p>
        <div class="row">
          <span class="chip"><span class="k">Output:</span> <b>probleemgebieden</b> + <b>zorgbundels</b></span>
          <span class="chip"><span class="k">Doel:</span> <b>sneller ontslag</b> + <b>duidelijk takenpakket</b></span>
          <span class="chip"><span class="k">Gebruik:</span> sociale dienst / co√∂rdinatieplatform</span>
        </div>
      </div>
    </section>

    <div class="grid">
      <!-- LEFT: FORM -->
      <section class="card">
        <div class="card-h">
          <div>
            <h2>1) Basisinfo & Intake</h2>
            <p class="sub">Start met minimale gegevens. Daarna probleemgebieden: enkel wat relevant is klapt open.</p>
          </div>
          <div class="mini" id="autosaveHint">Lokaal concept (geen server)</div>
        </div>

        <div class="card-b">
          <form id="zsForm" autocomplete="on">
            <div class="form-grid">
              <div>
                <label>Naam</label>
                <input name="naam" placeholder="Voornaam + naam" />
              </div>
              <div>
                <label>Rijksregisternummer</label>
                <input name="rrn" placeholder="xx.xx.xx-xxx.xx" />
              </div>
              <div>
                <label>Telefoon</label>
                <input name="tel" placeholder="+32..." />
              </div>
              <div>
                <label>Mutualiteit</label>
                <input name="mut" placeholder="bv. CM, Solidaris..." />
              </div>
              <div style="grid-column:1/-1">
                <label>Adres</label>
                <input name="adres" placeholder="Straat + nr, postcode, gemeente" />
              </div>
              <div>
                <label>Huisarts</label>
                <input name="huisarts" placeholder="Naam arts (optioneel)" />
              </div>
              <div>
                <label>Mantelzorg / contactpersoon</label>
                <input name="mantel" placeholder="Naam + telefoon (optioneel)" />
              </div>
            </div>

            <!-- PROBLEEMGEBIEDEN -->
            <div style="margin-top:14px;">
              <div class="mini">2) Probleemgebieden (klik om open te klappen)</div>

              <!-- COGNITIE -->
              <div class="section" data-open="1" data-section="cognitie">
                <div class="sec-h" role="button" tabindex="0">
                  <div class="ttl"><span class="ico">üß†</span> Cognitie & ori√´ntatie</div>
                  <div class="meta" id="meta-cognitie">‚Äî</div>
                </div>
                <div class="sec-b">
                  <div class="checks">
                    <label class="check">
                      <input type="checkbox" name="cog_desorient" data-pb="Cognitie" data-score="2" />
                      <div><b>Desori√´ntatie</b><span>tijd/plaats/personen; wisselend bewustzijn</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="cog_dementie" data-pb="Cognitie" data-score="2" />
                      <div><b>Dementie gekend</b><span>diagnose of duidelijke signalen</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="cog_delir" data-pb="Cognitie" data-score="3" />
                      <div><b>Delirium recent</b><span>tijdens opname of recent thuis</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="cog_medicatievergeet" data-pb="Medicatie" data-score="2" data-reveal="#rev-medicatie-adherentie" />
                      <div><b>Medicatie wordt vergeten</b><span>therapietrouw onzeker</span></div>
                    </label>
                  </div>

                  <div class="reveal" id="rev-medicatie-adherentie">
                    <div class="form-grid">
                      <div>
                        <label>Kan pati√´nt zelf medicatie beheren?</label>
                        <select name="med_self">
                          <option value="">Kies‚Ä¶</option>
                          <option>Ja, zelfstandig</option>
                          <option>Gedeeltelijk (hulp nodig)</option>
                          <option>Nee</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                      <div>
                        <label>Risico op verwarring/verwisseling?</label>
                        <select name="med_confusion">
                          <option value="">Kies‚Ä¶</option>
                          <option>Laag</option>
                          <option>Middel</option>
                          <option>Hoog</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                    </div>
                    <div class="help">Wordt gebruikt om zorgbundel ‚Äúmedicatiebegeleiding‚Äù zwaarder of lichter te maken.</div>
                  </div>
                </div>
              </div>

              <!-- MOBILITEIT -->
              <div class="section" data-open="0" data-section="mobiliteit">
                <div class="sec-h" role="button" tabindex="0">
                  <div class="ttl"><span class="ico">üö∂</span> Mobiliteit & valrisico</div>
                  <div class="meta" id="meta-mobiliteit">‚Äî</div>
                </div>
                <div class="sec-b">
                  <div class="checks">
                    <label class="check">
                      <input type="checkbox" name="mob_stappen" data-pb="Mobiliteit" data-score="2" data-reveal="#rev-mob-hulpmiddel" />
                      <div><b>Moeilijk stappen</b><span>kortademig, instabiel, beperkte afstand</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="mob_transfers" data-pb="Mobiliteit" data-score="2" data-reveal="#rev-mob-transfers" />
                      <div><b>Transfers moeilijk</b><span>bed/stoel/toilet, hulp nodig</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="mob_val" data-pb="Valrisico" data-score="3" data-reveal="#rev-val-details" />
                      <div><b>Val in laatste 12 maanden</b><span>of bijna-val met letsel</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="mob_trap" data-pb="Woonomgeving" data-score="1" data-reveal="#rev-woning-trap" />
                      <div><b>Trappen in woning</b><span>zonder lift / uitdagende toegang</span></div>
                    </label>
                  </div>

                  <div class="reveal" id="rev-mob-hulpmiddel">
                    <label>Is een hulpmiddel nodig?</label>
                    <select name="mob_hulpmiddel">
                      <option value="">Kies‚Ä¶</option>
                      <option>Geen</option>
                      <option>Stok</option>
                      <option>Rollator</option>
                      <option>Rolstoel</option>
                      <option>Onbekend</option>
                    </select>
                  </div>

                  <div class="reveal" id="rev-mob-transfers">
                    <div class="form-grid">
                      <div>
                        <label>Transfers: hulp van persoon nodig?</label>
                        <select name="transfer_hulp">
                          <option value="">Kies‚Ä¶</option>
                          <option>Nee</option>
                          <option>Ja, 1 persoon</option>
                          <option>Ja, 2 personen / tillift</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                      <div>
                        <label>Tillift of glijhulpmiddel aanwezig?</label>
                        <select name="transfer_tools">
                          <option value="">Kies‚Ä¶</option>
                          <option>Ja</option>
                          <option>Nee</option>
                          <option>Te voorzien</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div class="reveal" id="rev-val-details">
                    <div class="form-grid">
                      <div>
                        <label>Aantal vallen</label>
                        <select name="val_aantal">
                          <option value="">Kies‚Ä¶</option>
                          <option>1</option>
                          <option>2</option>
                          <option>3 of meer</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                      <div>
                        <label>Letsel na val?</label>
                        <select name="val_letsel">
                          <option value="">Kies‚Ä¶</option>
                          <option>Nee</option>
                          <option>Ja, licht</option>
                          <option>Ja, ernstig</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                    </div>
                    <div class="help">Val + alleenwonend = hogere prioriteit voor valpreventie + personenalarm.</div>
                  </div>

                  <div class="reveal" id="rev-woning-trap">
                    <div class="form-grid">
                      <div>
                        <label>Trap naar slaapkamer/badkamer?</label>
                        <select name="trap_kritisch">
                          <option value="">Kies‚Ä¶</option>
                          <option>Ja</option>
                          <option>Nee</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                      <div>
                        <label>Leuning / veilige toegang?</label>
                        <select name="trap_veilig">
                          <option value="">Kies‚Ä¶</option>
                          <option>Ja</option>
                          <option>Nee</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- MEDICATIE -->
              <div class="section" data-open="0" data-section="medicatie">
                <div class="sec-h" role="button" tabindex="0">
                  <div class="ttl"><span class="ico">üíä</span> Medicatie & polyfarmacie</div>
                  <div class="meta" id="meta-medicatie">‚Äî</div>
                </div>
                <div class="sec-b">
                  <div class="form-grid">
                    <div>
                      <label>Aantal medicaties</label>
                      <input type="number" name="med_aantal" min="0" placeholder="bv. 7" />
                      <div class="help">Vanaf &gt;5 wordt ‚Äúpolyfarmacie‚Äù geactiveerd.</div>
                    </div>
                    <div>
                      <label>Complex schema?</label>
                      <select name="med_complex">
                        <option value="">Kies‚Ä¶</option>
                        <option>Nee</option>
                        <option>Ja, meerdere innamemomenten</option>
                        <option>Ja, injecties/insuline</option>
                        <option>Onbekend</option>
                      </select>
                    </div>
                  </div>

                  <div class="checks" style="margin-top:10px;">
                    <label class="check">
                      <input type="checkbox" name="med_anticoag" data-pb="Medicatie" data-score="2" data-reveal="#rev-med-anticoag" />
                      <div><b>Anticoagulatie</b><span>NOAC/Marcoumar‚Ä¶ (monitoring / risico)</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="med_inject" data-pb="Technische zorg" data-score="2" data-reveal="#rev-med-inject" />
                      <div><b>Injecties nodig</b><span>insuline of andere SC/IM</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="med_baxter" data-pb="Medicatie" data-score="1" />
                      <div><b>Baxter/medicatierol</b><span>of weekbox georganiseerd</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="med_overzicht" data-pb="Medicatie" data-score="1" data-reveal="#rev-med-schema" />
                      <div><b>Schema ontbreekt</b><span>actueel medicatieschema niet beschikbaar</span></div>
                    </label>
                  </div>

                  <div class="reveal" id="rev-med-anticoag">
                    <div class="form-grid">
                      <div>
                        <label>Type</label>
                        <select name="anticoag_type">
                          <option value="">Kies‚Ä¶</option>
                          <option>NOAC (bv. apixaban, rivaroxaban‚Ä¶)</option>
                          <option>Vitamine K antagonist (Marcoumar/Sintrom)</option>
                          <option>LMWH (spuitjes)</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                      <div>
                        <label>Opvolging geregeld?</label>
                        <select name="anticoag_follow">
                          <option value="">Kies‚Ä¶</option>
                          <option>Ja</option>
                          <option>Nee</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div class="reveal" id="rev-med-inject">
                    <div class="form-grid">
                      <div>
                        <label>Frequentie</label>
                        <select name="inject_freq">
                          <option value="">Kies‚Ä¶</option>
                          <option>Dagelijks</option>
                          <option>Meerdere keren per dag</option>
                          <option>Wekelijks</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                      <div>
                        <label>Kan pati√´nt zelf injecteren?</label>
                        <select name="inject_self">
                          <option value="">Kies‚Ä¶</option>
                          <option>Ja</option>
                          <option>Nee</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div class="reveal" id="rev-med-schema">
                    <label>Wie kan actueel schema bezorgen?</label>
                    <select name="schema_bron">
                      <option value="">Kies‚Ä¶</option>
                      <option>Huisarts</option>
                      <option>Apotheek</option>
                      <option>Ziekenhuis / ontslagbrief</option>
                      <option>Mantelzorger</option>
                      <option>Onbekend</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- WOND/TECH -->
              <div class="section" data-open="0" data-section="technisch">
                <div class="sec-h" role="button" tabindex="0">
                  <div class="ttl"><span class="ico">ü©∫</span> Wondzorg & technische zorg</div>
                  <div class="meta" id="meta-technisch">‚Äî</div>
                </div>
                <div class="sec-b">
                  <div class="checks">
                    <label class="check">
                      <input type="checkbox" name="tech_wonde" data-pb="Wondzorg" data-score="2" data-reveal="#rev-wonde-details" />
                      <div><b>Postoperatieve / acute wonde</b><span>verband, controle, opvolging</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="tech_decub" data-pb="Wondzorg" data-score="3" data-reveal="#rev-decub" />
                      <div><b>Decubitus</b><span>risico of aanwezig</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="tech_katheter" data-pb="Technische zorg" data-score="2" data-reveal="#rev-katheter" />
                      <div><b>Katheter / urostoma</b><span>zorg en opvolging</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="tech_stoma" data-pb="Technische zorg" data-score="2" data-reveal="#rev-stoma" />
                      <div><b>Stoma</b><span>educatie / materiaalbeheer</span></div>
                    </label>
                  </div>

                  <div class="reveal" id="rev-wonde-details">
                    <div class="form-grid">
                      <div>
                        <label>Type wonde</label>
                        <select name="wonde_type">
                          <option value="">Kies‚Ä¶</option>
                          <option>Postoperatief</option>
                          <option>Trauma</option>
                          <option>Ulcus</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                      <div>
                        <label>Frequentie verbandwissel</label>
                        <select name="wonde_freq">
                          <option value="">Kies‚Ä¶</option>
                          <option>Dagelijks</option>
                          <option>Om de 2 dagen</option>
                          <option>2‚Äì3x/week</option>
                          <option>Wekelijks</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div class="reveal" id="rev-decub">
                    <div class="form-grid">
                      <div>
                        <label>Decubitus stadium</label>
                        <select name="decub_stage">
                          <option value="">Kies‚Ä¶</option>
                          <option>Risico (geen wonde)</option>
                          <option>Stadium 1</option>
                          <option>Stadium 2</option>
                          <option>Stadium 3-4</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                      <div>
                        <label>Antidecubitus matras aanwezig?</label>
                        <select name="decub_matras">
                          <option value="">Kies‚Ä¶</option>
                          <option>Ja</option>
                          <option>Nee</option>
                          <option>Te voorzien</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div class="reveal" id="rev-katheter">
                    <div class="form-grid">
                      <div>
                        <label>Type</label>
                        <select name="katheter_type">
                          <option value="">Kies‚Ä¶</option>
                          <option>Blaaskatheter</option>
                          <option>Suprapubische katheter</option>
                          <option>Condoomkatheter</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                      <div>
                        <label>Problemen (lekken/pijn/koorts)?</label>
                        <select name="katheter_prob">
                          <option value="">Kies‚Ä¶</option>
                          <option>Nee</option>
                          <option>Ja</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div class="reveal" id="rev-stoma">
                    <label>Is stoma-educatie gewenst?</label>
                    <select name="stoma_educ">
                      <option value="">Kies‚Ä¶</option>
                      <option>Ja</option>
                      <option>Nee</option>
                      <option>Onbekend</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- SOCIAAL/WONEN -->
              <div class="section" data-open="0" data-section="sociaal">
                <div class="sec-h" role="button" tabindex="0">
                  <div class="ttl"><span class="ico">üè†</span> Wooncontext, netwerk & kwetsbaarheid</div>
                  <div class="meta" id="meta-sociaal">‚Äî</div>
                </div>
                <div class="sec-b">
                  <div class="checks">
                    <label class="check">
                      <input type="checkbox" name="soc_alleen" data-pb="Wooncontext" data-score="3" data-reveal="#rev-alleen" />
                      <div><b>Alleenwonend</b><span>of geen steun mogelijk in huis</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="soc_mantel_overlast" data-pb="Mantelzorg" data-score="2" data-reveal="#rev-mantel" />
                      <div><b>Mantelzorger overbelast</b><span>dreigt uitval / conflict / draagkracht laag</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="soc_fin" data-pb="Financieel" data-score="2" />
                      <div><b>Financi√´le problemen</b><span>zorgkosten, administratie, VT?</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="soc_taal" data-pb="Communicatie" data-score="1" data-reveal="#rev-taal" />
                      <div><b>Taal/gezondheidsgeletterdheid</b><span>uitleg moeilijk, extra ondersteuning</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="soc_psych" data-pb="Psychisch" data-score="2" data-reveal="#rev-psych" />
                      <div><b>Psychische kwetsbaarheid</b><span>angst/depressie/verslaving/isolatie</span></div>
                    </label>
                    <label class="check">
                      <input type="checkbox" name="soc_alarm" data-pb="Veiligheid" data-score="2" data-reveal="#rev-alarm" />
                      <div><b>Personenalarm wenselijk</b><span>valrisico, alleen, onzekerheid</span></div>
                    </label>
                  </div>

                  <div class="reveal" id="rev-alleen">
                    <div class="form-grid">
                      <div>
                        <label>Is er dagelijks contact mogelijk?</label>
                        <select name="alleen_contact">
                          <option value="">Kies‚Ä¶</option>
                          <option>Ja</option>
                          <option>Nee</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                      <div>
                        <label>Toegang tot woning veilig (sleutel/kluis)?</label>
                        <select name="toegang">
                          <option value="">Kies‚Ä¶</option>
                          <option>Ja</option>
                          <option>Nee</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div class="reveal" id="rev-mantel">
                    <label>Wat is de hoofdreden van belasting?</label>
                    <select name="mantel_reason">
                      <option value="">Kies‚Ä¶</option>
                      <option>Tijd/overname zorgtaken</option>
                      <option>Emotioneel</option>
                      <option>Conflicten/afstemming</option>
                      <option>Eigen gezondheid mantelzorger</option>
                      <option>Onbekend</option>
                    </select>
                  </div>

                  <div class="reveal" id="rev-taal">
                    <div class="form-grid">
                      <div>
                        <label>Voorkeurstaal</label>
                        <input name="taal" placeholder="bv. NL/FR/EN/..." />
                      </div>
                      <div>
                        <label>Tolk / ondersteuning nodig?</label>
                        <select name="tolk">
                          <option value="">Kies‚Ä¶</option>
                          <option>Ja</option>
                          <option>Nee</option>
                          <option>Onbekend</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div class="reveal" id="rev-psych">
                    <label>Welke signalen?</label>
                    <select name="psych_type">
                      <option value="">Kies‚Ä¶</option>
                      <option>Angst</option>
                      <option>Depressie</option>
                      <option>Verslaving</option>
                      <option>Sociaal isolement</option>
                      <option>Onbekend</option>
                    </select>
                  </div>

                  <div class="reveal" id="rev-alarm">
                    <label>Alarm reeds aanwezig?</label>
                    <select name="alarm_status">
                      <option value="">Kies‚Ä¶</option>
                      <option>Ja</option>
                      <option>Nee</option>
                      <option>Te voorzien</option>
                      <option>Onbekend</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- VRIJE TEKST -->
              <div class="section" data-open="0" data-section="opm">
                <div class="sec-h" role="button" tabindex="0">
                  <div class="ttl"><span class="ico">üìù</span> Aanvullende info</div>
                  <div class="meta" id="meta-opm">‚Äî</div>
                </div>
                <div class="sec-b">
                  <label>Vrije opmerkingen (kort)</label>
                  <textarea name="opm" placeholder="Wat moeten we zeker weten? (bv. ontslagdatum, huisarts bereikt, materiaal besteld, ...)"></textarea>
                  <div class="help">Vrije tekst blijft, maar de kerninfo zit in de probleemgebieden + openklappers.</div>
                </div>
              </div>

              <div class="btnbar">
                <button type="button" class="btn primary" id="btnCompute">Genereer zorgbundels & samenvatting</button>
                <button type="button" class="btn" id="btnReset">Reset</button>
                <button type="button" class="btn" id="btnCopy">Kopieer samenvatting</button>
              </div>
              <div class="footer-note">
                Tip: dit is een ‚Äúsingle-file‚Äù prototype. Je kan dit later koppelen aan Zorgstart (API/EPD), of de output naar een
                ‚Äútakenpakket + matching‚Äù pipeline sturen.
              </div>
            </div>
          </form>
        </div>
      </section>

      <!-- RIGHT: OUTPUT -->
      <aside class="card">
        <div class="card-h">
          <div>
            <h2>2) Output: Probleemgebieden & Zorgbundels</h2>
            <p class="sub">Realtime score + suggesties. Dit paneel is wat je later als ‚ÄúZorgstart V1 output‚Äù kan registreren.</p>
          </div>
          <span class="badge" id="statusBadge">Wacht op input</span>
        </div>

        <div class="card-b">
          <div class="kpi">
            <div class="stat">
              <div class="n" id="scoreTotal">0</div>
              <div class="t">Kwetsbaarheidsscore (prototype)</div>
            </div>
            <div class="stat">
              <div class="n" id="pbCount">0</div>
              <div class="t">Geactiveerde probleemgebieden</div>
            </div>
          </div>

          <div class="list" id="bundleList">
            <div class="item">
              <div class="h">
                <b>Geen bundels (nog)</b>
                <span class="tag">‚Äî</span>
              </div>
              <p>Vul links de probleemgebieden in. Klik daarna op ‚ÄúGenereer zorgbundels & samenvatting‚Äù.</p>
            </div>
          </div>

          <pre id="jsonOut">{}</pre>
        </div>
      </aside>
    </div>
  </div>

<script>
/* ===========================
   Zorgstart Slimme Intake
   - Progressive disclosure (reveal blocks)
   - Probleemgebieden + scores
   - Bundel-voorstel (rules)
   - JSON output + copy
   =========================== */

const $ = (sel, root=document) => root.querySelector(sel);
const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

const form = $("#zsForm");
const statusBadge = $("#statusBadge");
const scoreTotalEl = $("#scoreTotal");
const pbCountEl = $("#pbCount");
const bundleList = $("#bundleList");
const jsonOut = $("#jsonOut");

const PB = {
  Cognitie: {label:"Cognitie & ori√´ntatie"},
  Mobiliteit: {label:"Mobiliteit"},
  Valrisico: {label:"Valrisico"},
  Medicatie: {label:"Medicatie & polyfarmacie"},
  Wondzorg: {label:"Wondzorg"},
  "Technische zorg": {label:"Technische zorg"},
  Wooncontext: {label:"Wooncontext"},
  Mantelzorg: {label:"Mantelzorgbelasting"},
  Financieel: {label:"Financi√´le kwetsbaarheid"},
  Communicatie: {label:"Taal/gezondheidsgeletterdheid"},
  Psychisch: {label:"Psychisch welzijn"},
  Veiligheid: {label:"Veiligheid / personenalarm"}
};

function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

function severityTag(score){
  if(score >= 9) return {cls:"bad", txt:"hoog"};
  if(score >= 5) return {cls:"warn", txt:"matig"};
  return {cls:"good", txt:"laag"};
}

function toggleSection(el){
  const sec = el.closest(".section");
  const open = sec.getAttribute("data-open") === "1";
  sec.setAttribute("data-open", open ? "0" : "1");
}

function updateRevealForInput(inp){
  const sel = inp.getAttribute("data-reveal");
  if(!sel) return;
  const rev = $(sel);
  if(!rev) return;
  const show = (inp.type === "checkbox") ? inp.checked : !!inp.value;
  rev.setAttribute("data-show", show ? "1" : "0");
}

function updateMeta(){
  // Simple per-section meta: count checked
  const sections = $$(".section");
  sections.forEach(sec => {
    const id = sec.getAttribute("data-section");
    const meta = $("#meta-" + id);
    if(!meta) return;
    const checks = $$("input[type=checkbox]", sec);
    const checked = checks.filter(c => c.checked).length;
    meta.textContent = checked ? `${checked} signal(en)` : "‚Äî";
  });
}

function collectData(){
  const data = {};
  const fd = new FormData(form);
  for(const [k,v] of fd.entries()){
    // keep empty fields out (except we still want present? -> keep non-empty)
    if(v !== "") data[k] = v;
  }
  // add checkboxes explicitly
  $$("input[type=checkbox]", form).forEach(c => {
    data[c.name] = !!c.checked;
  });
  return data;
}

function computePB(){
  const pbScores = {};
  let total = 0;

  // Checkbox-driven scoring
  $$("input[type=checkbox][data-pb]", form).forEach(c => {
    if(!c.checked) return;
    const pb = c.getAttribute("data-pb");
    const s = Number(c.getAttribute("data-score") || "1");
    pbScores[pb] = (pbScores[pb] || 0) + s;
    total += s;
  });

  // Medicatie count rule (polyfarmacie)
  const medAantal = Number($("input[name=med_aantal]").value || "0");
  if(medAantal > 5){
    pbScores["Medicatie"] = (pbScores["Medicatie"] || 0) + 2;
    total += 2;
  }
  // Complex schema rule
  const medComplex = ($("select[name=med_complex]").value || "");
  if(medComplex.includes("Ja")){ pbScores["Medicatie"] = (pbScores["Medicatie"] || 0) + 1; total += 1; }

  // Safety amplification: alone + falls
  const alleen = $("input[name=soc_alleen]").checked;
  const val = $("input[name=mob_val]").checked;
  if(alleen && val){
    pbScores["Veiligheid"] = (pbScores["Veiligheid"] || 0) + 2;
    total += 2;
  }

  return {pbScores, total};
}

function suggestBundles(pbScores, data){
  // RULES -> bundles
  const bundles = [];

  const has = (k, min=1) => (pbScores[k] || 0) >= min;

  // 1) Medicatiebegeleiding
  const medAantal = Number(data.med_aantal || "0");
  const medRisk = has("Medicatie", 2) || medAantal > 5 || (data.med_confusion === "Hoog") || data.cog_medicatievergeet;
  if(medRisk){
    bundles.push({
      name:"Zorgbundel: Medicatiebegeleiding",
      why:[
        medAantal > 5 ? "Polyfarmacie (>5 medicaties)" : null,
        data.med_complex ? `Schema: ${data.med_complex}` : null,
        data.med_confusion ? `Verwarringsrisico: ${data.med_confusion}` : null,
        data.cog_medicatievergeet ? "Therapietrouw onzeker" : null
      ].filter(Boolean),
      prio: medAantal > 8 || data.med_confusion==="Hoog" ? "hoog" : "matig"
    });
  }

  // 2) Valpreventie / mobiliteit
  if(has("Valrisico",2) || has("Mobiliteit",2)){
    bundles.push({
      name:"Zorgbundel: Mobiliteit & valpreventie",
      why:[
        data.mob_val ? "Valincident(en) gemeld" : null,
        data.mob_stappen ? "Stapproblemen" : null,
        data.mob_transfers ? "Transfers moeilijk" : null,
        data.mob_hulpmiddel ? `Hulpmiddel: ${data.mob_hulpmiddel}` : null
      ].filter(Boolean),
      prio: (data.mob_val && data.soc_alleen) ? "hoog" : "matig"
    });
  }

  // 3) Technische thuisverpleging
  if(has("Wondzorg",2) || has("Technische zorg",2)){
    bundles.push({
      name:"Zorgbundel: Technische thuisverpleging",
      why:[
        data.tech_wonde ? `Wonde: ${data.wonde_type || "onbekend"} (${data.wonde_freq || "freq onbekend"})` : null,
        data.tech_decub ? `Decubitus: ${data.decub_stage || "onbekend"} (matras: ${data.decub_matras || "onbekend"})` : null,
        data.tech_katheter ? `Katheter: ${data.katheter_type || "onbekend"}` : null,
        data.tech_stoma ? `Stoma: educatie ${data.stoma_educ || "onbekend"}` : null,
        data.med_inject ? `Injecties: ${data.inject_freq || "freq onbekend"} (zelf: ${data.inject_self || "onbekend"})` : null
      ].filter(Boolean),
      prio: (data.tech_decub && (data.decub_stage||"").includes("3")) ? "hoog" : "matig"
    });
  }

  // 4) Veiligheid / personenalarm
  const safety = has("Veiligheid",2) || (data.soc_alarm) || (data.soc_alleen && data.mob_val);
  if(safety){
    bundles.push({
      name:"Zorgbundel: Veiligheid thuis",
      why:[
        data.soc_alarm ? `Personenalarm: ${data.alarm_status || "onbekend"}` : null,
        (data.soc_alleen && data.mob_val) ? "Alleenwonend + valrisico (prioriteit)" : null,
        data.cog_desorient ? "Desori√´ntatie" : null
      ].filter(Boolean),
      prio: (data.soc_alleen && data.mob_val) ? "hoog" : "matig"
    });
  }

  // 5) Netwerk / mantelzorg / communicatie
  if(has("Wooncontext",2) || has("Mantelzorg",2) || has("Communicatie",1) || has("Financieel",1)){
    bundles.push({
      name:"Zorgbundel: Co√∂rdinatie & netwerkondersteuning",
      why:[
        data.soc_alleen ? `Alleenwonend (contact: ${data.alleen_contact || "onbekend"})` : null,
        data.soc_mantel_overlast ? `Mantelzorger overbelast (${data.mantel_reason || "reden onbekend"})` : null,
        data.soc_taal ? `Communicatie: taal ${data.taal || "onbekend"}, tolk ${data.tolk || "onbekend"}` : null,
        data.soc_fin ? "Financi√´le kwetsbaarheid" : null
      ].filter(Boolean),
      prio: (data.soc_alleen && data.soc_mantel_overlast) ? "hoog" : "matig"
    });
  }

  // If none: suggest minimal
  if(!bundles.length){
    bundles.push({
      name:"Geen bundel (nog) ‚Äî minimale opvolging",
      why:["Onvoldoende signalen aangevinkt om een bundel te activeren."],
      prio:"laag"
    });
  }

  return bundles;
}

function renderOutput(){
  const data = collectData();
  const {pbScores, total} = computePB();
  const pbKeys = Object.keys(pbScores).sort((a,b)=> (pbScores[b]-pbScores[a]));
  const bundles = suggestBundles(pbScores, data);

  const sev = severityTag(total);
  statusBadge.textContent = `Kwetsbaarheid: ${sev.txt}`;
  statusBadge.className = `badge`;

  scoreTotalEl.textContent = String(total);
  pbCountEl.textContent = String(pbKeys.length);

  // Bundles cards
  bundleList.innerHTML = "";
  bundles.forEach(b => {
    const pr = b.prio === "hoog" ? "bad" : (b.prio === "matig" ? "warn" : "good");
    const el = document.createElement("div");
    el.className = "item";
    el.innerHTML = `
      <div class="h">
        <b>${escapeHtml(b.name)}</b>
        <span class="tag ${pr}">${escapeHtml(b.prio)}</span>
      </div>
      <p>${b.why.length ? b.why.map(escapeHtml).join(" ‚Ä¢ ") : "‚Äî"}</p>
    `;
    bundleList.appendChild(el);
  });

  const out = {
    patient: {
      naam: data.naam || "",
      rrn: data.rrn || "",
      tel: data.tel || "",
      mutualiteit: data.mut || "",
      adres: data.adres || "",
      huisarts: data.huisarts || "",
      mantel: data.mantel || ""
    },
    probleemgebieden: pbKeys.map(k => ({
      key: k,
      label: (PB[k] && PB[k].label) ? PB[k].label : k,
      score: pbScores[k]
    })),
    kwetsbaarheidScore: total,
    zorgbundels: bundles,
    vrijeOpmerking: data.opm || ""
  };

  jsonOut.textContent = JSON.stringify(out, null, 2);
}

function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, (c)=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;" }[c]));
}

/* --------------------------
   EVENTS
--------------------------- */

// Accordion toggles
$$(".sec-h").forEach(h => {
  h.addEventListener("click", ()=> toggleSection(h));
  h.addEventListener("keydown", (e)=> {
    if(e.key === "Enter" || e.key === " "){ e.preventDefault(); toggleSection(h); }
  });
});

// Reveal logic for checkboxes & selects (if any with data-reveal)
form.addEventListener("change", (e) => {
  const t = e.target;
  if(!(t instanceof HTMLElement)) return;

  if(t.matches("input[type=checkbox][data-reveal]")){
    updateRevealForInput(t);
  }

  // auto-open section if something checked inside
  if(t.matches("input[type=checkbox]")){
    const sec = t.closest(".section");
    if(sec && t.checked) sec.setAttribute("data-open","1");
  }

  // update meta counts
  updateMeta();
});

// Initialize reveal blocks based on default state
$$("input[type=checkbox][data-reveal]").forEach(updateRevealForInput);
updateMeta();

// Button actions
$("#btnCompute").addEventListener("click", () => {
  renderOutput();
  // also auto-open right-side by updating badge state visually
});

$("#btnReset").addEventListener("click", () => {
  form.reset();
  // close optional sections except first
  $$(".section").forEach((s,i)=> s.setAttribute("data-open", i===0 ? "1":"0"));
  // hide all reveals
  $$(".reveal").forEach(r => r.setAttribute("data-show","0"));
  // reset right panel
  statusBadge.textContent = "Wacht op input";
  scoreTotalEl.textContent = "0";
  pbCountEl.textContent = "0";
  bundleList.innerHTML = `
    <div class="item">
      <div class="h"><b>Geen bundels (nog)</b><span class="tag">‚Äî</span></div>
      <p>Vul links de probleemgebieden in. Klik daarna op ‚ÄúGenereer zorgbundels & samenvatting‚Äù.</p>
    </div>`;
  jsonOut.textContent = "{}";
  updateMeta();
});

$("#btnCopy").addEventListener("click", async () => {
  const txt = jsonOut.textContent || "{}";
  try{
    await navigator.clipboard.writeText(txt);
    $("#autosaveHint").textContent = "Samenvatting gekopieerd ‚úî";
    setTimeout(()=> $("#autosaveHint").textContent = "Lokaal concept (geen server)", 1800);
  }catch(err){
    alert("Kopi√´ren lukt niet in deze browser-context. Selecteer en kopieer handmatig.");
  }
});
</script>
</body>
</html>
